# Loki configuration overrides for SingleBinary deployment
deploymentMode: SingleBinary

loki:
  # Internal authentication toggle
  auth_enabled: false

  limits_config:
    # Global log retention period
    retention_period: 168h
    # Maximum lookback period for log queries
    max_query_lookback: 168h
    # Rejection threshold for older log samples
    reject_old_samples: true
    reject_old_samples_max_age: 168h

  commonConfig:
    # Ingester replication factor
    replication_factor: 1

  storage:
    type: filesystem

  schemaConfig:
    configs:
      - from: "2024-04-01"
        store: tsdb
        object_store: filesystem
        schema: v13
        index:
          prefix: index_
          period: 24h

  compactor:
    # Compactor-based retention configuration
    retention_enabled: true
    delete_request_store: filesystem

# Scalability settings for distributed components
write:
  replicas: 0
read:
  replicas: 0
backend:
  replicas: 0

# Cache memory allocation (in MB)
chunksCache:
  allocatedMemory: 256

# Persistence configuration for SingleBinary mode
singleBinary:
  replicas: 1
  persistence:
    # Automatic StatefulSet recreation for PVC expansion
    enableStatefulSetRecreationForSizeChange: true
    # Persistent Volume Claim storage size
    size: 5Gi
    storageClass: longhorn

# Network policy and traffic rules
networkPolicy:
  enabled: true
  metrics:
    namespaceSelector:
      matchExpressions:
        - key: kubernetes.io/metadata.name
          operator: In
          values:
            - prometheus
            - alloy
            - loki
  ingress:
    namespaceSelector:
      matchExpressions:
        - key: kubernetes.io/metadata.name
          operator: In
          values:
            - grafana-instance
            - prometheus
            - alloy
            - loki
