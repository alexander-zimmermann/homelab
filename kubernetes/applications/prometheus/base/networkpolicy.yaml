apiVersion: networking.k8s.io/v1
kind: NetworkPolicy

metadata:
  name: prometheus-server-access
  namespace: prometheus
spec:
  podSelector:
    matchLabels:
      app.kubernetes.io/name: prometheus
      app.kubernetes.io/component: server
  policyTypes:
    - Ingress
    - Egress
  ingress:
    # Allow access from monitoring components (Grafana, Alloy, Prometheus itself)
    - from:
        - namespaceSelector:
            matchExpressions:
              - key: kubernetes.io/metadata.name
                operator: In
                values:
                  - grafana-instance
                  - alloy
                  - prometheus
                  - ingress-controller
  egress:
    # Allow all egress (needed for scraping)
    - {}
