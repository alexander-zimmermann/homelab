# Use a stable, short name for all rendered resources.
fullnameOverride: prometheus

# Reduce duplicate prefixes for objects created by the Prometheus Operator.
# This primarily affects generated StatefulSet/Pod names.
cleanPrometheusOperatorObjectNames: true

# Grafana runs as a separate app in this repo.
grafana:
  enabled: false

# Disable exporters/components that are provided elsewhere.
kubeStateMetrics:
  enabled: false

nodeExporter:
  enabled: false

# Prometheus Operator resources: requests influence scheduling/QoS; limits enforce a hard cap.
prometheusOperator:
  resources:
    requests:
      cpu: 10m
      memory: 96Mi
    limits:
      cpu: 200m
      memory: 256Mi

  # Resources for the config-reloader sidecar injected into Prometheus/Alertmanager pods.
  prometheusConfigReloader:
    resources:
      requests:
        cpu: 5m
        memory: 32Mi
      limits:
        cpu: 50m
        memory: 64Mi

  admissionWebhooks:
    # Jobs that patch webhook configurations / generate certs.
    patch:
      resources:
        requests:
          cpu: 5m
          memory: 32Mi
        limits:
          cpu: 50m
          memory: 64Mi

alertmanager:
  alertmanagerSpec:
    # Alertmanager resources: requests influence scheduling/QoS; limits enforce a hard cap.
    resources:
      requests:
        cpu: 5m
        memory: 64Mi
      limits:
        cpu: 100m
        memory: 256Mi

    # Persist Alertmanager state.
    storage:
      volumeClaimTemplate:
        spec:
          storageClassName: longhorn
          accessModes:
            - ReadWriteOnce
          resources:
            requests:
              # Alertmanager is tiny; this is mostly for stable PVC lifecycle.
              storage: 128Mi

prometheus:
  prometheusSpec:
    # Required for remote_write receiver (e.g. for agent-based ingestion).
    enableRemoteWriteReceiver: true

    # Keep 30d of metrics for homelab trend analysis.
    retention: 30d

    # Prometheus resources: requests influence scheduling/QoS; limits enforce a hard cap.
    resources:
      requests:
        cpu: 100m
        memory: 256Mi
      limits:
        cpu: 500m
        memory: 1Gi

    # Persist TSDB data.
    storageSpec:
      volumeClaimTemplate:
        spec:
          storageClassName: longhorn
          accessModes:
            - ReadWriteOnce
          resources:
            requests:
              storage: 5Gi
