deployment:
  # Deploy as a Deployment for controlled scaling (alternate: DaemonSet)
  kind: Deployment
  # High Availability: Spread pods across nodes

# Pod anti-affinity forces scheduler to put traefik pods on nodes where no other traefik pods are scheduled
affinity:
  podAntiAffinity:
    requiredDuringSchedulingIgnoredDuringExecution:
      - labelSelector:
          matchLabels:
            app.kubernetes.io/name: traefik
        topologyKey: kubernetes.io/hostname

# Pod Disruption Budget: Ensure at least one replica is available during maintenance
podDisruptionBudget:
  enabled: true
  minAvailable: 1

ingressRoute:
  dashboard:
    # Enable the dashboard ingress route
    enabled: true
    # Router match rule
    matchRule: Host(`PLACEHOLDER`)
    # Entry points for the dashboard
    entryPoints: ["websecure"]
    # TLS configuration
    tls:
      secretName: traefik-tls-cert

ports:
  # Web entry point (Port 80)
  web:
    port: 8000
    expose:
      default: true
    exposedPort: 80
    http:
      redirections:
        entryPoint:
          to: websecure
          scheme: https
          permanent: true
  # Websecure entry point (Port 443)
  websecure:
    port: 8443
    expose:
      default: true
    exposedPort: 443
    http:
      tls:
        enabled: true

service:
  # Expose Traefik UI via Cilium/BGP-announced LoadBalancer
  type: LoadBalancer
  labels:
    bgp.cilium.io/ip-pool: default
    bgp.cilium.io/advertise-service: default


# Logging: Enable JSON access logs for better observability
logs:
  general:
    level: INFO
  access:
    enabled: true
    format: json

# Prometheus Metrics (Opt-In)
metrics:
  prometheus:
    serviceMonitor:
      enabled: true
      labels:
        release: prometheus
