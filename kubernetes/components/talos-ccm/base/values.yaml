transformations:
  # Identify Talos data-plane nodes by hostname and set the conventional worker role label.
  - name: worker-role
    nodeSelector:
      - matchExpressions:
          - key: Hostname
            operator: Regexp
            values:
              - ^talos-dp-.*$
    labels:
      node-role.kubernetes.io/worker: ""

  # CCM-applied label used by Longhorn for node selection (and disk gating).
  - name: longhorn-storage
    nodeSelector:
      - matchExpressions:
          - key: Hostname
            operator: Regexp
            values:
              - ^talos-dp-.*$
    labels:
      node.longhorn.io/create-default-disk: "true"

# Talos CCM resources: requests influence scheduling/QoS; limits enforce a hard cap.
resources:
  requests:
    cpu: 10m
    memory: 64Mi
  limits:
    cpu: 100m
    memory: 128Mi
