# =======================================================
# Read metrics from MQTT topic(s)
# =======================================================
[[inputs.mqtt_consumer]]
  ## Broker URLs for the MQTT server or cluster
  servers = ["tcp://mqtt.zimmermann.eu.com:1883"]

  ## Username and password to connect MQTT server
  username = "telegraf"
  password = "@{docker_secretstore:telegraf_mqtt_password}"

  ## Data format to consume.
  ## https://github.com/influxdata/telegraf/blob/master/docs/DATA_FORMATS_INPUT.md
  data_format = "json"

  ## Topics that will be subscribed to
  topics = [
    "ems-esp/boiler_data",
    "ems-esp/boiler_data_dhw",
    "ems-esp/thermostat_data",
    "ems-esp/thermostat_data_hc1",
    "ems-esp/thermostat_data_dhw",
    "ems-esp/mixer_data",
    "ems-esp/mixer_data_hc1",
  ]

  ## Enable extracting tag values from MQTT topics
  ## _ denotes an ignored entry in the topic path,
  ## # denotes a variable length path element (can only be used once per setting)
  [[inputs.mqtt_consumer.topic_parsing]]
    topic = "ems-esp/+"
    measurement = "measurement/_"
